---
import { Image } from 'astro:assets'
import Button from '@components/Button.astro'
const { src, title, text, url, href } = Astro.props
---

<div class="card" role="article" aria-labelledby="project-title-{title}">
  <div class="card-image-container">
    <Image src={src} alt={title} loading="lazy" />
    <div class="card-text-container">
      <h3>{title}</h3>
      <p class="body-text">
        {text}
      </p>
      <Button
        href={href}
        rel="noopener noreferrer"
        color="secondary"
        class="card-button"
        showExternalIcon={true}
        aria-label={`Visit ${title} website (opens in new tab)`}
      >
        {url}
      </Button>
    </div>
  </div>
</div>

<style>
  @property --gradient-percent {
    syntax: '<percentage>';
    initial-value: 0%;
    inherits: false;
  }
  @property --gradient-opacity {
    syntax: '<number>';
    initial-value: 0;
    inherits: false;
  }

  .card {
    width: 100%;
    height: max(45rem, 100%);
    overflow: hidden;
    background-color: var(--bg-surface);
    border-radius: var(--br-02);
    box-shadow: var(--shadow-shallow);
    border: var(--image-border);
    transition:
      transform 280ms ease-out,
      box-shadow 680ms ease-out;
    position: relative;
  }

  .card :global(.card-button)::after {
    content: '';
    position: absolute;
    inset: 0; /* Covers the entire card */
    z-index: 10; /* Sits above card content */
  }

  /* .card:hover,
  .card:has(:focus-visible) {
    transform: translateY(-5px);
    box-shadow: var(--shadow-deep);
  } */

  .card:hover,
  .card:focus-within {
    transform: translateY(-5px);
    box-shadow: var(--shadow-deep);
    cursor: pointer;
  }

  .card:hover :global(.card-button),
  .card:focus-within :global(.card-button) {
    background-color: var(--button-secondary__hover);
  }

  .card-text-container {
    display: flex;
    flex-direction: column;
    /* justify-content: space-between; */
    gap: var(--sp-02);
    padding-inline: var(--sp-05);
    padding-block: var(--sp-06);
    z-index: 2;
  }

  .card-image-container {
    aspect-ratio: 4 / 3;
    position: relative;
  }
  .card-image-container::after {
    aspect-ratio: 4 / 3;
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(
      to top,
      oklch(from var(--blue-200) l c h / var(--gradient-opacity)),
      oklch(from var(--blue-200) l c h / 0.02) var(--gradient-percent)
    );
    z-index: 1;
    transition:
      --gradient-percent 280ms ease-out,
      --gradient-opacity 380ms ease-out;
  }

  .card:hover .card-image-container::after,
  .card:focus-within .card-image-container::after {
    --gradient-percent: 20%;
    --gradient-opacity: 0.3;
    background: linear-gradient(
      to top,
      oklch(from var(--blue-200) l c h / var(--gradient-opacity)),
      oklch(from var(--blue-200) l c h / 0) var(--gradient-percent)
    );
  }

  .card-image-container img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .body-text {
    margin-bottom: var(--sp-04);
  }
</style>
